{% extends 'base.html' %}

{% block title %}Профиль пользователя{% endblock %}

{% block content %}
<h1>Профиль пользователя</h1>

<p><strong>Никнейм:</strong> {{ username }}</p>
<p><strong>Почта:</strong> {{ email }}</p>
<p><strong>Возраст:</strong> {{ age }}</p>
<p><strong>Любимый жанр:</strong> {{ favorite_genre }}</p>

<hr>

<h2>Мои книги</h2>
{% if user_books %}
    <table id="user-catalog">
        <thead>
            <tr>
                <th>Название книги</th>
                <th>Автор</th>
                <th>Оценка</th>
                <th>Отзыв</th>
                <th>Действия</th>
            </tr>
        </thead>
        <tbody>
            {% for user_book in user_books %}
                <tr>
                    <td>{{ user_book.book.name }}</td>
                    <td>{{ user_book.book.author }}</td>
                    <td>
                        {% if user_book.rating %}
                            {{ user_book.rating }}/5
                        {% else %}
                            —
                        {% endif %}
                    </td>
                    <td>
                        {% if user_book.review %}
                            {{ user_book.review }}
                        {% else %}
                            —
                        {% endif %}
                    </td>
                    <td>
                        <form method="POST" action="{{ url_for('profile.update_book', user_book_id=user_book.id) }}">
                            <input type="number" name="rating" min="1" max="5"
                                   value="{{ user_book.rating or '' }}" placeholder="1-5">
                            <textarea name="review" rows="2"
                                      placeholder="Ваш отзыв">{{ user_book.review or '' }}</textarea>
                            <button type="submit">Сохранить</button>
                        </form>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <p>У вас пока нет книг в каталоге. Зайдите в <a href="{{ url_for('catalog.catalog') }}">каталог</a> и добавьте первую!</p>
{% endif %}

<a href="{{ url_for('catalog.catalog') }}">← К общему каталогу</a>
{% endblock %}